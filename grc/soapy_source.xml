<?xml version="1.0"?>
<block>
  <name>Soapy Source</name>
  <key>soapy_source</key>
  <category>[soapy]</category>
  <import>import soapy</import>

  <make>\
      soapy.source($freq, $gain, $samp_rate, $bw, $antenna, $chan, \ 
      $dc_offset, $dc_offset_auto_mode, $gain_auto_mode, $correction, $balance,\
      $clock_source, $clock_rate, $dev) \
  </make>

  <callback>set_gain($chan, $gain)</callback>
  <callback>set_frequency($chan, $freq)</callback>

  <param>
    <name>Frequency</name>
    <key>freq</key>
    <type>float</type>
    <tab>RF Options</tab>
  </param>

  <param>
    <name>Gain</name>
    <key>gain</key>
    <type>float</type>
    <tab>RF Options</tab>
  </param>
  
  <param>
    <name>Automatic Gain</name>
    <key>gain_auto_mode</key>
    <value>False</value>
    <type>bool</type>
  </param>
  
  <param>
    <name>Sampling Rate</name>
    <key>samp_rate</key>
    <type>float</type>
    <tab>RF Options</tab>
  </param>

  <param>
    <name>Bandwidth</name>
    <key>bw</key>
    <type>float</type>
    <tab>RF Options</tab>
  </param>
  
  <param>
      <name>Antenna</name>
      <key>antenna</key>
      <type>string</type>
      <tab>RF Options</tab>
  </param>

  <param>
      <name>Num Channels</name>
      <key>chan</key>
      <value>1</value>
      <type>int</type>
  </param>

  <param>
      <name>DC Offset</name>
      <key>dc_offset</key>
      <type>complex</type>
  </param>

  <param>
      <name>Automatic DC Offset Mode</name>
      <key>dc_offset_auto_mode</key>
      <value>False</value>
      <type>bool</type>
  </param>

  <param>
      <name>Frequency Correction</name>
      <key>correction</key>
      <value>0</value>
      <type>real</type>
  </param>
  
  <param>
      <name>Master Clock Rate</name>
      <key>clock_rate</key>
      <type>real</type>
  </param>

  <param>
      <name>IQ Balance Correction</name>
      <key>balance</key>
      <type>complex</type>
  </param>
  
  <param>
      <name>Clock Source</name>
      <key>clock_source</key>
      <type>string</type>
  </param>

  <param>
    <name>Device</name>
    <key>dev</key>
    <type>string</type>
  </param>

  <sink>
  	<name>command</name>
  	<type>message</type>
  	 <optional>1</optional>
  </sink>
  
  <source>
    <name>out</name>
    <type>complex</type>
    <nports>$chan</nports>
  </source>
</block>
